generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model document {
  id              String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  filename        String
  s3_url          String
  created_at      DateTime          @default(now()) @db.Timestamptz(6)
  document_vector document_vector[]
  user            user?             @relation(fields: [userId], references: [id])
  userId          String?           @db.Uuid
  channel         channel?          @relation(fields: [channelId], references: [id])
  channelId       String?           @db.Uuid
}

model document_vector {
  id          String                @id(map: "documentvector_pkey") @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  document_id String                @db.Uuid
  vector      Unsupported("vector")
  metadata    Json?
  created_at  DateTime              @default(now()) @db.Timestamptz(6)
  document    document              @relation(fields: [document_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "documentvector_document_id_fkey")

  @@index([vector])
}

model user {
  id         String     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  email      String     @unique
  password   String
  name       String
  created_at DateTime   @default(now()) @db.Timestamptz(6)
  updated_at DateTime?  @db.Timestamptz(6)
  documents  document[]
  channel    channel[]
}

model channel {
  id         String     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name       String
  created_at DateTime   @default(now()) @db.Timestamptz(6)
  updated_at DateTime?  @db.Timestamptz(6)
  document   document[]
  messages   message[]
  user       user       @relation(fields: [userId], references: [id])
  userId     String     @db.Uuid
}

model message {
  id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  text       String
  created_at DateTime  @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @db.Timestamptz(6)
  userId     String    @db.Uuid
  channel    channel   @relation(fields: [channelId], references: [id])
  channelId  String    @db.Uuid
}
